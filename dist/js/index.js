"use strict";setTimeout(function(){function n(n){$("#banner img").each(function(t,e){e.src=n[t].pUrl}),$("#banner a").each(function(t,e){var a=$(e);a.attr("href",n[t].url)}),$("#banner").swiper({loop:!0,autoplay:5e3,pagination:".swiper-pagination"})}function t(n){for(var t="",e=0;e<n.length;e++){var a=n[e];t+='\n            <li>\n            <a href="'+$.getMovDetails(a.id)+'" class="external">\n                <div class="imgbox">\n                    <img src="'+a.stills+'" />\n                    <p class="name">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+'</p>\n                </div>\n                <p class="text">'+a.introduction+"</p>\n            </a>\n            </li>\n            "}$("#rec1 ul").append(t)}function e(n){$(".recommended-2 a").each(function(t,e){var a=$(e);a.attr("href",$.getArtDetails(n[t].id)),a.find("img").attr("src",n[t].pictrueUrl),a.find(".titleInfo").text(n[t].title),a.find(".content-text").text(n[t].introduction)})}function a(n){for(var t="",e=0;e<n.length;e++){var a=n[e];t+='\n            <li>\n                <a class="external flexlist" href="'+$.getMovDetails(a.id)+'">\n                    <div class="imgbox">\n                        <img src="'+a.stills+'" alt="">\n                    </div>\n                    <div class="info">\n                        <span class="t"><span class="index">0'+(e+1)+"</span>"+a.title+'</span>\n                        <p class="text">'+a.introduction+'</p>\n                        <span class="text2">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+"</span>\n                    </div>\n                </a>\n            </li>\n            "}$("#rankTop").append(t)}function s(n){function t(n,t){for(var e="",a=0;a<t.length;a++){var s=t[a];e+='\n                <li>\n                    <a class="external flexlist" href="'+$.getMovDetails(s.id)+'">\n                        <div class="imgbox">\n                            <img src="'+s.stills+'" >\n                        </div>\n                        <div class="info">\n                            <span class="t"><span class="index">'+(a+1)+"</span>"+s.title+'</span>\n                            <p class="text">'+s.introduction+'</p>\n                            <span class="text2">'+$.getUpdateStatus(s.updateStatus,s.updateSite)+"</span>\n                        </div>\n                    </a>\n                </li>\n                "}$(n).empty().append(e)}$.showPreloader();var e=r.index(n)+1;$.ajax({url:"http://wechat.94joy.com/wx/rest/index/ranking",data:{type:e},success:function(a){console.log("排行type="+e,a),1==a.STATUS&&t(n,a.RANK_LIST)},error:function(n){console.log("排行加载出错",n)},complete:function(){$.hidePreloader()}})}function i(n){if(!n)return void console.error("调用搜索失败，因为搜索值为空");sessionStorage.searchName=n;var t=$(".search-list ul");$.showPreloader(),$.ajax({url:"http://wechat.94joy.com/wx/rest/index/search",data:{searchName:n},success:function(n){var e="";if(t.empty(),1==n.STATUS){for(var a=n.MOVIES.content,s=0;s<a.length;s++){var i=n.MOVIES.content[s],o=i.id<10?"0"+i.id:i.id;e+='\n                            <li>\n                                <a class="external flexlist" href="'+$.getMovDetails(i.id)+'">\n                                    <div class="imgbox">\n                                        <img src="'+i.stills+'" />\n                                    </div>\n                                    <div class="info">\n                                        <span class="t"><span class="index">'+o+"</span>"+i.title+'</span>\n                                        <p class="text">'+i.introduction+'</p>\n                                        <span class="text2">更新到第'+i.updateSite+"集</span>\n                                    </div>\n                                </a>\n                            </li>\n                           "}t.append(e),t.show()}else t.hide()},error:function(n){console.log(n),$.alert("搜索出错，请稍后再试")},complete:function(){$.hidePreloader()}})}$.showPreloader(),$.ajax({type:"get",dataType:"json",url:"http://wechat.94joy.com/wx/rest/index/index",success:function(s){console.log("首页数据",s),n(s.headerRes),t(s.bestMovies),e(s.mainRes),a(s.rankTop)},error:function(n){console.log("首页加载出错",n),$.alert("首页加载出错，请稍后再试")},complete:function(){$.hidePreloader()}});var o=$(".ranking .tab-link"),r=$(".ranking .hotlist");o.one("click",function(){s(r[$(this).index()])}),$("#rank-indexbtn").one("click",function(){s(r[0])});var l=$(".search-tools input");l.on("input",function(){l.not($(this)).val($(this).val())}),$(document).on("click",".search",function(n){n.stopPropagation();var t=$(this);if(t.hasClass("search-open")&&$(".search-tools").toggleClass("search-show"),t.hasClass("search-btn")){var e=$.trim(t.parent().find("input").val());if(!e)return;i(e)}}),sessionStorage.searchName&&(i(sessionStorage.searchName),l.val(sessionStorage.searchName)),$(window).on("popstate",function(){""==location.hash&&($(".page").removeClass("page-current"),$("#index-default").addClass("page-current"))});var c=$("#tablist a");c.click(function(){var n=$(this).index();sessionStorage.indexTab=n}),sessionStorage.indexTab&&c.eq(sessionStorage.indexTab).click()},100);