"use strict";setTimeout(function(){function e(e){$("#banner img").each(function(n,t){t.src=e[n].pUrl}),$("#banner a").each(function(n,t){var a=$(t);a.attr("href",$.getArtDetails(e[n].url))}),$("#banner").swiper({loop:!0,autoplay:5e3,pagination:".swiper-pagination"})}function n(e){for(var n="",t=0;t<e.length;t++){var a=e[t];n+='\n            <li>\n            <a href="'+$.getMovDetails(a.id)+'" class="external">\n                <div class="imgbox">\n                    <img src="'+a.poster+'" />\n                    <p class="name">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+'</p>\n                </div>\n                <p class="text">'+a.title+"</p>\n            </a>\n            </li>\n            "}$("#rec1 ul").append(n)}function t(e){for(var n=$(".recommended-2 .box1"),t=$(".recommended-2 .box2 a"),a=[],s=0;s<e.length;s++)1==e[s].type?(n.attr("href",$.getArtDetails(e[s].resUrl)),n.find("img").attr("src",e[s].pictrueUrl),n.find(".titleInfo").text(e[s].title),n.find(".content-text").text(e[s].introduction)):a.push(e[s]);t.each(function(e,n){n.href=$.getArtDetails(a[e].resUrl),n.querySelector("img").src=a[e].pictrueUrl,n.querySelector(".titleInfo").innerHTML=a[e].title,n.querySelector(".content-text").innerHTML=a[e].introduction})}function a(e){for(var n="",t=0;t<e.length;t++){var a=e[t];n+='\n            <li>\n                <a class="external flexlist" href="'+$.getMovDetails(a.id)+'">\n                    <div class="imgbox">\n                        <img src="'+a.poster+'" alt="">\n                    </div>\n                    <div class="info">\n                        <span class="t"><span class="index">0'+(t+1)+"</span>"+a.title+'</span>\n                        <p class="text">'+a.introduction+'</p>\n                        <span class="text2">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+"</span>\n                    </div>\n                </a>\n            </li>\n            "}$("#rankTop").append(n)}function s(e){function n(e,n){for(var t="",a=0;a<n.length;a++){var s=n[a];t+='\n                <li>\n                    <a class="external flexlist" href="'+$.getMovDetails(s.id)+'">\n                        <div class="imgbox">\n                            <img src="'+s.poster+'" >\n                        </div>\n                        <div class="info">\n                            <span class="t"><span class="index">'+(a+1)+"</span>"+s.title+'</span>\n                            <p class="text">'+s.introduction+'</p>\n                            <span class="text2">'+$.getUpdateStatus(s.updateStatus,s.updateSite)+"</span>\n                        </div>\n                    </a>\n                </li>\n                "}$(e).empty().append(t)}$.showPreloader();var t=r.index(e)+1;$.ajax({url:"http://www.funying.cn/wx/rest/index/ranking",data:{type:t},success:function(a){console.log("排行type="+t,a),1==a.STATUS&&n(e,a.RANK_LIST)},error:function(e){console.log("排行加载出错",e)},complete:function(){$.hidePreloader()}})}function i(e){if(!e)return void console.error("调用搜索失败，因为搜索值为空");e=$.trim(e),sessionStorage.searchName=e;var n=$(".search-list ul");$.showPreloader(),$.ajax({url:"http://www.funying.cn/wx/rest/index/search",data:{searchName:e},success:function(e){console.log("搜索数据：",e);var t="";if(n.empty(),1==e.STATUS){for(var a=e.MOVIES.content,s=0;s<a.length;s++){var i=e.MOVIES.content[s],o=i.id<10?"0"+i.id:i.id;t+='\n                            <li>\n                                <a class="external flexlist" href="'+$.getMovDetails(i.id)+'">\n                                    <div class="imgbox">\n                                        <img src="'+i.poster+'" />\n                                    </div>\n                                    <div class="info">\n                                        <span class="t"><span class="index">'+o+"</span>"+i.title+'</span>\n                                        <p class="text">'+i.introduction+'</p>\n                                        <span class="text2">'+$.getUpdateStatus(i.updateStatus,i.updateSite)+"</span>\n                                    </div>\n                                </a>\n                            </li>\n                           "}n.append(t),n.show()}else n.hide()},error:function(e){console.log(e),$.alert("搜索出错，请稍后再试")},complete:function(){$.hidePreloader()}})}$.showPreloader(),$.ajax({type:"get",dataType:"json",url:"http://www.funying.cn/wx/rest/index/index",success:function(s){console.log("首页数据",s),e(s.headerRes),n(s.bestMovies),t(s.mainRes),a(s.rankTop)},error:function(e){console.log("首页加载出错",e),$.alert("首页加载出错，请稍后再试")},complete:function(){$.hidePreloader()}});var o=$(".ranking .tab-link"),r=$(".ranking .hotlist");o.one("click",function(){s(r[$(this).index()])}),$("#rank-indexbtn").one("click",function(){s(r[0])});var c=$(".search-tools input");c.on("input",function(){c.not($(this)).val($(this).val())}).on("keyup",function(){13==event.keyCode&&$(".search-btn").eq(0).click()}),$(document).on("click",".search",function(e){e.stopPropagation();var n=$(this);if(n.hasClass("search-open")&&$(".search-tools").toggleClass("search-show"),n.hasClass("search-btn")){var t=n.parent().find("input").val();i(t)}}),sessionStorage.searchName&&(i(sessionStorage.searchName),c.val(sessionStorage.searchName)),$(window).on("popstate",function(){""==location.hash&&($(".page").removeClass("page-current"),$("#index-default").addClass("page-current"))});var l=$("#tablist a");l.click(function(){var e=$(this).index();sessionStorage.indexTab=e}),sessionStorage.indexTab&&l.eq(sessionStorage.indexTab).click()},100);