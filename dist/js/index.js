"use strict";setTimeout(function(){function n(n){$("#banner img").each(function(e,t){t.src=n[e].pUrl}),$("#banner a").each(function(e,t){var a=$(t);a.attr("href",$.getArtDetails(n[e].url))}),$("#banner").swiper({loop:!0,autoplay:5e3,pagination:".swiper-pagination"})}function e(n){for(var e="",t=0;t<n.length;t++){var a=n[t];e+='\n            <li>\n            <a href="'+$.getMovDetails(a.id)+'" class="external">\n                <div class="imgbox">\n                    <img src="'+a.poster+'" />\n                    <p class="name">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+'</p>\n                </div>\n                <p class="text">'+a.introduction+"</p>\n            </a>\n            </li>\n            "}$("#rec1 ul").append(e)}function t(n){for(var e=$(".recommended-2 .box1"),t=$(".recommended-2 .box2 a"),a=[],s=0;s<n.length;s++)1==n[s].type?(e.attr("href",$.getArtDetails(n[s].resUrl)),e.find("img").attr("src",n[s].pictrueUrl),e.find(".titleInfo").text(n[s].title),e.find(".content-text").text(n[s].introduction)):a.push(n[s]);t.each(function(n,e){e.href=$.getArtDetails(a[n].resUrl),e.querySelector("img").src=a[n].pictrueUrl,e.querySelector(".titleInfo").innerHTML=a[n].title,e.querySelector(".content-text").innerHTML=a[n].introduction})}function a(n){for(var e="",t=0;t<n.length;t++){var a=n[t];e+='\n            <li>\n                <a class="external flexlist" href="'+$.getMovDetails(a.id)+'">\n                    <div class="imgbox">\n                        <img src="'+a.poster+'" alt="">\n                    </div>\n                    <div class="info">\n                        <span class="t"><span class="index">0'+(t+1)+"</span>"+a.title+'</span>\n                        <p class="text">'+a.introduction+'</p>\n                        <span class="text2">'+$.getUpdateStatus(a.updateStatus,a.updateSite)+"</span>\n                    </div>\n                </a>\n            </li>\n            "}$("#rankTop").append(e)}function s(n){function e(n,e){for(var t="",a=0;a<e.length;a++){var s=e[a];t+='\n                <li>\n                    <a class="external flexlist" href="'+$.getMovDetails(s.id)+'">\n                        <div class="imgbox">\n                            <img src="'+s.poster+'" >\n                        </div>\n                        <div class="info">\n                            <span class="t"><span class="index">'+(a+1)+"</span>"+s.title+'</span>\n                            <p class="text">'+s.introduction+'</p>\n                            <span class="text2">'+$.getUpdateStatus(s.updateStatus,s.updateSite)+"</span>\n                        </div>\n                    </a>\n                </li>\n                "}$(n).empty().append(t)}$.showPreloader();var t=r.index(n)+1;$.ajax({url:"http://www.funying.cn/wx/rest/index/ranking",data:{type:t},success:function(a){console.log("排行type="+t,a),1==a.STATUS&&e(n,a.RANK_LIST)},error:function(n){console.log("排行加载出错",n)},complete:function(){$.hidePreloader()}})}function i(n){if(!n)return void console.error("调用搜索失败，因为搜索值为空");sessionStorage.searchName=n;var e=$(".search-list ul");$.showPreloader(),$.ajax({url:"http://www.funying.cn/wx/rest/index/search",data:{searchName:n},success:function(n){console.log("搜索数据：",n);var t="";if(e.empty(),1==n.STATUS){for(var a=n.MOVIES.content,s=0;s<a.length;s++){var i=n.MOVIES.content[s],o=i.id<10?"0"+i.id:i.id;t+='\n                            <li>\n                                <a class="external flexlist" href="'+$.getMovDetails(i.id)+'">\n                                    <div class="imgbox">\n                                        <img src="'+i.poster+'" />\n                                    </div>\n                                    <div class="info">\n                                        <span class="t"><span class="index">'+o+"</span>"+i.title+'</span>\n                                        <p class="text">'+i.introduction+'</p>\n                                        <span class="text2">更新到第'+i.updateSite+"集</span>\n                                    </div>\n                                </a>\n                            </li>\n                           "}e.append(t),e.show()}else e.hide()},error:function(n){console.log(n),$.alert("搜索出错，请稍后再试")},complete:function(){$.hidePreloader()}})}$.showPreloader(),$.ajax({type:"get",dataType:"json",url:"http://www.funying.cn/wx/rest/index/index",success:function(s){console.log("首页数据",s),n(s.headerRes),e(s.bestMovies),t(s.mainRes),a(s.rankTop)},error:function(n){console.log("首页加载出错",n),$.alert("首页加载出错，请稍后再试")},complete:function(){$.hidePreloader()}});var o=$(".ranking .tab-link"),r=$(".ranking .hotlist");o.one("click",function(){s(r[$(this).index()])}),$("#rank-indexbtn").one("click",function(){s(r[0])});var l=$(".search-tools input");l.on("input",function(){l.not($(this)).val($(this).val())}),$(document).on("click",".search",function(n){n.stopPropagation();var e=$(this);if(e.hasClass("search-open")&&$(".search-tools").toggleClass("search-show"),e.hasClass("search-btn")){var t=$.trim(e.parent().find("input").val());if(!t)return;i(t)}}),sessionStorage.searchName&&(i(sessionStorage.searchName),l.val(sessionStorage.searchName)),$(window).on("popstate",function(){""==location.hash&&($(".page").removeClass("page-current"),$("#index-default").addClass("page-current"))});var c=$("#tablist a");c.click(function(){var n=$(this).index();sessionStorage.indexTab=n}),sessionStorage.indexTab&&c.eq(sessionStorage.indexTab).click()},100);