"use strict";setTimeout(function(){function e(){function e(){$.alert("加入购物车失败，请稍后再试！"),a.prop("disabled",!1)}a.prop("disabled",!0),$.ajax({url:"http://wechat.94joy.com/wx/rest/index/addMovie",data:{openId:$.openId,movieId:n},success:function(t){1==t.STATUS?$.toast("加入购物车成功"):e()},error:function(){e()}})}function t(e){window.location.href=e}function o(o){var a=o.MOVIE,r=o.MOVIE_SERIES;$("#qrcode").attr("src",o.QR_CODE),c.removeClass("hide"),1==o.IS_SUBSCRIBE&&$("#qrcodeBox").remove(),1==o.IS_CART&&$("#addCart").remove(),1==o.IS_BUY?c.remove():$(".numbox").hide();for(var i in a){var s=$("#"+i);s.length&&("img"==s[0].localName?s.attr("src",a.poster):s.text(a[i]))}var u=$("#price");u.text(Number(u.text()).toFixed(2));for(var l="",m=0;m<r.length;m++)l+='\n                <a href="javascript:" class="num">'+(m+1)+"</a>\n            ";$(".numbox").html(l),d.on("click",".button-group .btn",function(){var t=$(this);t.hasClass("buy")&&(1==o.IS_SUBSCRIBE?$.payment({movieId:n,success:function(){c.remove(),$(".numbox").show(),$.msg("该影片购买成功,您可以在详情页查看资源地址了！",5e3)},wxPay:{type:1,title:"影视详情-影片购买"}}):$.msg("您还不是会员，无法购买，先扫描页面下方二维码成为会员吧！")),t.hasClass("cart")&&(1==o.IS_SUBSCRIBE?e(t):$.msg("您还不是会员，无法加入购物车，先扫描页面下方二维码成为会员吧！"))}),d.on("click",".num",function(){var e=$(this).index(),o=[{text:"主线资源",onClick:function(){t(r[e].resourceUrl)}},{text:"备用地址1",onClick:function(){t(r[e].otherOne)}},{text:"备用地址2",onClick:function(){t(r[e].otherTwo)}},{text:"取消"}];$.actions(o)})}var n=$.GetQueryString("movieId"),a=$("#addCart"),c=$("#isbuy"),r=$("#detail-tab3"),i=$("#feedbackContext"),s=$("#feedbackSubmit");$.showPreloader();var d=$(".details");$.ajax({url:"http://wechat.94joy.com/wx/rest/index/getMovie",data:{movieId:n,openId:$.openId,oldOpenId:$.GetQueryString("oldOpenId")},success:function(e){console.log("影视详情数据：",e),1==e.STATUS?o(e):$.alert("没有该影片信息！",function(){$.router.back()})},error:function(e){var t="影视详情页获取失败，稍后再试！";console.log(t,e),$.alert(t,function(){$.router.back()})},complete:function(){$.hidePreloader()}}),r.on("click",".sub-tag span",function(){i.val(i.val()+"#"+$(this).text()+"#")}),s.on("click",function(){var e=$(this);i.val()&&(e.prop("disabled",!0),$.ajax({url:"http://wechat.94joy.com/wx/rest/index/feedback",data:{context:$("#feedbackContext").val(),movieId:n},success:function(){$.msg("谢谢你的反馈！"),i.val("")},complete:function(){e.prop("disabled",!1)}}))})},100);